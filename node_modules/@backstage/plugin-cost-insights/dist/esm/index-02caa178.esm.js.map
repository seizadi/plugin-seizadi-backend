{"version":3,"file":"index-02caa178.esm.js","sources":["../../src/components/ActionItems/ActionItemCard.tsx","../../src/components/ActionItems/ActionItems.tsx","../../src/components/AlertInsights/AlertDialog.tsx","../../src/components/AlertInsights/AlertStatusSummary.tsx","../../src/components/AlertInsights/AlertStatusSummaryButton.tsx","../../src/utils/scroll.tsx","../../src/components/AlertInsights/AlertInsightsHeader.tsx","../../src/components/AlertInsights/AlertInsightsSectionHeader.tsx","../../src/components/AlertInsights/AlertInsightsSection.tsx","../../src/components/AlertInsights/AlertInsights.tsx","../../src/components/CopyUrlToClipboard/CopyUrlToClipboard.tsx","../../src/components/CostInsightsHeader/CostInsightsHeader.tsx","../../src/components/CurrencySelect/CurrencySelect.tsx","../../src/components/WhyCostsMatter/WhyCostsMatter.tsx","../../src/utils/charts.ts","../../src/components/CostOverviewCard/selector.tsx","../../src/components/CostOverviewCard/CostOverviewLegend.tsx","../../src/components/CostOverviewCard/CostOverviewChart.tsx","../../src/utils/sum.ts","../../src/components/CostOverviewCard/CostOverviewBreakdownChart.tsx","../../src/components/CostOverviewCard/CostOverviewHeader.tsx","../../src/components/MetricSelect/MetricSelect.tsx","../../src/components/PeriodSelect/PeriodSelect.tsx","../../src/components/CostOverviewCard/CostOverviewCard.tsx","../../src/components/ProductInsightsCard/ProductInsightsCard.tsx","../../src/components/ProductInsightsCard/ProductInsightsCardList.tsx","../../src/components/ProductInsights/ProductInsights.tsx","../../src/components/CostInsightsPage/selector.tsx","../../src/components/ProjectSelect/ProjectSelect.tsx","../../src/components/CostInsightsPage/CostInsightsPage.tsx","../../src/components/CostInsightsPage/CostInsightsPageRoot.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, { MouseEventHandler } from 'react';\nimport classnames from 'classnames';\nimport { Card, CardHeader } from '@material-ui/core';\nimport { useScroll } from '../../hooks';\nimport { Alert } from '../../types';\nimport { useActionItemCardStyles as useStyles } from '../../utils/styles';\n\ntype ActionItemCardProps = {\n  alert: Alert;\n  number?: number;\n  avatar?: JSX.Element;\n  disableScroll?: boolean;\n};\n\nexport const ActionItemCard = ({\n  alert,\n  avatar,\n  number,\n  disableScroll = false,\n}: ActionItemCardProps) => {\n  const classes = useStyles();\n  const rootClasses = classnames(classes.root, {\n    [classes.activeRoot]: !disableScroll,\n  });\n  const [, setScroll] = useScroll();\n\n  const onActionItemClick: MouseEventHandler = () => {\n    if (!disableScroll && number) {\n      setScroll(`alert-${number}`);\n    }\n  };\n\n  return (\n    <Card className={classes.card} raised={false} onClick={onActionItemClick}>\n      <CardHeader\n        classes={{\n          root: rootClasses,\n          action: classes.action,\n          title: classes.title,\n        }}\n        title={alert.title}\n        subheader={alert.subtitle}\n        avatar={avatar}\n      />\n    </Card>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, { Fragment, MouseEventHandler } from 'react';\nimport {\n  Avatar,\n  Badge,\n  Box,\n  IconButtonProps,\n  IconButton,\n  Paper,\n  Divider,\n  Tooltip,\n} from '@material-ui/core';\nimport { default as SnoozeIcon } from '@material-ui/icons/AccessTime';\nimport { default as AcceptIcon } from '@material-ui/icons/Check';\nimport { default as DismissIcon } from '@material-ui/icons/Delete';\nimport { ActionItemCard } from './ActionItemCard';\nimport { Alert, AlertStatus } from '../../types';\nimport { useScroll, ScrollType } from '../../hooks';\nimport { useActionItemCardStyles as useStyles } from '../../utils/styles';\n\ntype AlertStatusButtonProps = {\n  title: string;\n  amount: number;\n  icon: JSX.Element;\n  onClick: MouseEventHandler;\n} & IconButtonProps;\n\nconst AlertStatusButton = ({\n  title,\n  amount,\n  icon,\n  onClick,\n  ...buttonProps\n}: AlertStatusButtonProps) => (\n  <Tooltip title={title}>\n    <IconButton\n      onClick={onClick}\n      role=\"button\"\n      aria-hidden={false}\n      {...buttonProps}\n    >\n      <Badge badgeContent={amount}>{icon}</Badge>\n    </IconButton>\n  </Tooltip>\n);\n\ntype ActionItemsProps = {\n  active: Alert[];\n  snoozed: Alert[];\n  accepted: Alert[];\n  dismissed: Alert[];\n};\n\nexport const ActionItems = ({\n  active,\n  snoozed,\n  accepted,\n  dismissed,\n}: ActionItemsProps) => {\n  const classes = useStyles();\n  const [, setScroll] = useScroll();\n\n  const isSnoozedButtonDisplayed = !!snoozed.length;\n  const isAcceptedButtonDisplayed = !!accepted.length;\n  const isDismissedButtonDisplayed = !!dismissed.length;\n  const isStatusButtonGroupDisplayed = !!active.length;\n\n  const onStatusButtonClick: MouseEventHandler = () =>\n    setScroll(ScrollType.AlertSummary);\n\n  return (\n    <>\n      <Paper>\n        {active.map((alert, index) => (\n          <Fragment key={`alert-${index}`}>\n            <ActionItemCard\n              alert={alert}\n              number={index + 1}\n              avatar={<Avatar className={classes.avatar}>{index + 1}</Avatar>}\n            />\n            {index < active.length - 1 && <Divider />}\n          </Fragment>\n        ))}\n      </Paper>\n      {isStatusButtonGroupDisplayed && (\n        <Box display=\"flex\" justifyContent=\"flex-end\" mt={2}>\n          {isAcceptedButtonDisplayed && (\n            <AlertStatusButton\n              title=\"Accepted\"\n              aria-label={AlertStatus.Accepted}\n              icon={<AcceptIcon />}\n              amount={accepted.length}\n              onClick={onStatusButtonClick}\n            />\n          )}\n          {isSnoozedButtonDisplayed && (\n            <AlertStatusButton\n              title=\"Snoozed\"\n              aria-label={AlertStatus.Snoozed}\n              amount={snoozed.length}\n              icon={<SnoozeIcon />}\n              onClick={onStatusButtonClick}\n            />\n          )}\n          {isDismissedButtonDisplayed && (\n            <AlertStatusButton\n              title=\"Dismissed\"\n              aria-label={AlertStatus.Dismissed}\n              icon={<DismissIcon />}\n              amount={dismissed.length}\n              onClick={onStatusButtonClick}\n            />\n          )}\n        </Box>\n      )}\n    </>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport {\n  capitalize,\n  Box,\n  Button,\n  Divider,\n  Dialog,\n  DialogActions,\n  IconButton,\n  DialogContent,\n  Typography,\n} from '@material-ui/core';\nimport { default as CloseIcon } from '@material-ui/icons/Close';\nimport { useAlertDialogStyles as useStyles } from '../../utils/styles';\nimport { Alert, AlertStatus, Maybe } from '../../types';\nimport { choose, formOf } from '../../utils/alerts';\n\nconst DEFAULT_FORM_ID = 'alert-form';\n\ntype AlertDialogProps = {\n  open: boolean;\n  group: string;\n  alert: Maybe<Alert>;\n  status: Maybe<AlertStatus>;\n  onClose: () => void;\n  onSubmit: (data: any) => void;\n};\n\nexport const AlertDialog = ({\n  open,\n  group,\n  alert,\n  status,\n  onClose,\n  onSubmit,\n}: AlertDialogProps) => {\n  const classes = useStyles();\n  const [isSubmitDisabled, setSubmitDisabled] = useState(true);\n  const formRef = useRef<Maybe<HTMLFormElement>>(null);\n\n  useEffect(() => {\n    setSubmitDisabled(open);\n  }, [open]);\n\n  function disableSubmit(isDisabled: boolean) {\n    setSubmitDisabled(isDisabled);\n  }\n\n  function onDialogClose() {\n    onClose();\n    setSubmitDisabled(true);\n  }\n\n  const [action, actioned] = choose(\n    status,\n    [\n      ['snooze', 'snoozed'],\n      ['accept', 'accepted'],\n      ['dismiss', 'dismissed'],\n    ],\n    ['', ''],\n  );\n\n  const TransitionProps = {\n    mountOnEnter: true,\n    unmountOnExit: true,\n    onEntered() {\n      if (formRef.current) {\n        formRef.current.id = DEFAULT_FORM_ID;\n      }\n    },\n  };\n\n  const Form = formOf(alert, status);\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onDialogClose}\n      scroll=\"body\"\n      maxWidth=\"lg\"\n      TransitionProps={TransitionProps}\n    >\n      <Box display=\"flex\" justifyContent=\"flex-end\">\n        <IconButton\n          className={classes.icon}\n          disableRipple\n          aria-label=\"Close\"\n          onClick={onDialogClose}\n        >\n          <CloseIcon />\n        </IconButton>\n      </Box>\n      <DialogContent className={classes.content}>\n        <Box mb={1.5}>\n          <Typography variant=\"h5\">\n            <b>{capitalize(action)} this action item?</b>\n          </Typography>\n          <Typography variant=\"h6\" color=\"textSecondary\">\n            <b>\n              This action item will be {actioned} for all of {group}.\n            </b>\n          </Typography>\n        </Box>\n        <Box\n          display=\"flex\"\n          flexDirection=\"column\"\n          bgcolor=\"alertBackground\"\n          p={2}\n          mb={1.5}\n          borderRadius={4}\n        >\n          <Typography>\n            <b>{alert?.title}</b>\n          </Typography>\n          <Typography color=\"textSecondary\">{alert?.subtitle}</Typography>\n        </Box>\n        {Form && (\n          <Form\n            ref={formRef}\n            alert={alert}\n            onSubmit={onSubmit}\n            disableSubmit={disableSubmit}\n          />\n        )}\n      </DialogContent>\n      <Divider />\n      <DialogActions className={classes.actions} disableSpacing>\n        {Form ? (\n          <Button\n            type=\"submit\"\n            color=\"primary\"\n            variant=\"contained\"\n            aria-label={action}\n            form={DEFAULT_FORM_ID}\n            disabled={isSubmitDisabled}\n          >\n            {capitalize(action)}\n          </Button>\n        ) : (\n          <Button\n            type=\"button\"\n            color=\"primary\"\n            variant=\"contained\"\n            aria-label={action}\n            onClick={() => onSubmit(null)}\n          >\n            {capitalize(action)}\n          </Button>\n        )}\n      </DialogActions>\n    </Dialog>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { Fragment } from 'react';\nimport { Avatar, Box, Collapse, Divider, Tooltip } from '@material-ui/core';\nimport { default as AcceptIcon } from '@material-ui/icons/Check';\nimport { default as DismissIcon } from '@material-ui/icons/Delete';\nimport { default as SnoozeIcon } from '@material-ui/icons/AccessTime';\nimport { ActionItemCard } from '../ActionItems';\nimport { Alert, AlertStatus } from '../../types';\nimport { useActionItemCardStyles as useStyles } from '../../utils/styles';\n\ntype AlertGroupProps = {\n  alerts: Alert[];\n  status: AlertStatus;\n  title: string;\n  icon: JSX.Element;\n};\n\nconst AlertGroup = ({ alerts, status, title, icon }: AlertGroupProps) => {\n  const classes = useStyles();\n  return (\n    <Box p={1}>\n      {alerts.map((alert, index) => (\n        <Fragment key={`alert-${status}-${index}`}>\n          <ActionItemCard\n            disableScroll\n            alert={alert}\n            avatar={\n              <Tooltip title={title}>\n                <Avatar className={classes.avatar}>{icon}</Avatar>\n              </Tooltip>\n            }\n          />\n          {index < alerts.length - 1 && <Divider />}\n        </Fragment>\n      ))}\n    </Box>\n  );\n};\n\ntype AlertStatusSummaryProps = {\n  open: boolean;\n  snoozed: Alert[];\n  accepted: Alert[];\n  dismissed: Alert[];\n};\n\nexport const AlertStatusSummary = ({\n  open,\n  snoozed,\n  accepted,\n  dismissed,\n}: AlertStatusSummaryProps) => {\n  const isSnoozedListDisplayed = !!snoozed.length;\n  const isAcceptedListDisplayed = !!accepted.length;\n  const isDismissedListDisplayed = !!dismissed.length;\n\n  return (\n    <Collapse in={open}>\n      {isAcceptedListDisplayed && (\n        <AlertGroup\n          title=\"Accepted\"\n          alerts={accepted}\n          status={AlertStatus.Accepted}\n          icon={\n            <AcceptIcon\n              role=\"img\"\n              aria-hidden={false}\n              aria-label={AlertStatus.Accepted}\n            />\n          }\n        />\n      )}\n      {isSnoozedListDisplayed && (\n        <AlertGroup\n          title=\"Snoozed\"\n          alerts={snoozed}\n          status={AlertStatus.Snoozed}\n          icon={\n            <SnoozeIcon\n              role=\"img\"\n              aria-hidden={false}\n              aria-label={AlertStatus.Snoozed}\n            />\n          }\n        />\n      )}\n      {isDismissedListDisplayed && (\n        <AlertGroup\n          title=\"Dismissed\"\n          alerts={dismissed}\n          status={AlertStatus.Dismissed}\n          icon={\n            <DismissIcon\n              role=\"img\"\n              aria-hidden={false}\n              aria-label={AlertStatus.Dismissed}\n            />\n          }\n        />\n      )}\n    </Collapse>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useState, MouseEventHandler, PropsWithChildren } from 'react';\nimport classnames from 'classnames';\nimport { Button } from '@material-ui/core';\nimport { default as ExpandMoreIcon } from '@material-ui/icons/ExpandMore';\nimport { useAlertStatusSummaryButtonStyles as useStyles } from '../../utils/styles';\n\ntype AlertStatusSummaryButtonProps = {\n  onClick: MouseEventHandler;\n};\n\nexport const AlertStatusSummaryButton = ({\n  children,\n  onClick,\n}: PropsWithChildren<AlertStatusSummaryButtonProps>) => {\n  const classes = useStyles();\n  const [clicked, setClicked] = useState(false);\n  const iconClassName = classnames(classes.icon, {\n    [classes.clicked]: clicked,\n  });\n\n  const handleOnClick: MouseEventHandler = e => {\n    setClicked(prevClicked => !prevClicked);\n    onClick(e);\n  };\n\n  return (\n    <Button\n      variant=\"text\"\n      color=\"primary\"\n      disableElevation\n      aria-label=\"expand\"\n      endIcon={<ExpandMoreIcon className={iconClassName} />}\n      onClick={handleOnClick}\n    >\n      {children}\n    </Button>\n  );\n};\n","/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, { useEffect, useRef } from 'react';\nimport { ScrollTo, useScroll } from '../hooks/useScroll';\n\n/*\n  Utility component use in conjuction with useScroll that allows scrollable components to control behavior and offset.\n  1. ScrollAnchor must be a direct child of a scrollable component.\n  2. ScrollAnchor's parent position must be relative. \n  3. ScrollAnchor's id must be unique.\n*/\n\nexport interface ScrollAnchorProps extends ScrollIntoViewOptions {\n  id: ScrollTo;\n  top?: number;\n  left?: number;\n}\n\nexport const ScrollAnchor = ({\n  id,\n  left = 0,\n  top = -20,\n  block = 'start',\n  inline = 'nearest',\n  behavior = 'smooth',\n}: ScrollAnchorProps) => {\n  const divRef = useRef<HTMLDivElement>(null);\n  const [scroll, setScroll] = useScroll();\n\n  useEffect(() => {\n    function scrollIntoView() {\n      if (divRef.current && scroll === id) {\n        divRef.current.scrollIntoView({\n          block,\n          inline,\n          behavior,\n        });\n        setScroll(null);\n      }\n    }\n\n    scrollIntoView();\n  }, [scroll, setScroll, id, behavior, block, inline]);\n\n  return (\n    <div\n      ref={divRef}\n      style={{ position: 'absolute', height: 0, width: 0, top, left }}\n      data-testid={`scroll-test-${id}`}\n    />\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { Box, Typography } from '@material-ui/core';\nimport { useCostInsightsStyles as useStyles } from '../../utils/styles';\nimport { ScrollAnchor } from '../../utils/scroll';\nimport { DefaultNavigation } from '../../utils/navigation';\n\ntype AlertInsightsHeaderProps = {\n  title: string;\n  subtitle: string;\n};\n\nexport const AlertInsightsHeader = ({\n  title,\n  subtitle,\n}: AlertInsightsHeaderProps) => {\n  const classes = useStyles();\n\n  return (\n    <Box mb={6} position=\"relative\">\n      <ScrollAnchor id={DefaultNavigation.AlertInsightsHeader} />\n      <Typography variant=\"h4\" align=\"center\">\n        {title}{' '}\n        <span role=\"img\" aria-label=\"direct-hit\">\n          üéØ\n        </span>\n      </Typography>\n      <Typography className={classes.h6Subtle} align=\"center\" gutterBottom>\n        {subtitle}\n      </Typography>\n    </Box>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { Avatar, Box, Button, Grid, Typography } from '@material-ui/core';\nimport { useAlertInsightsSectionStyles as useStyles } from '../../utils/styles';\nimport { ScrollAnchor } from '../../utils/scroll';\nimport { Alert } from '../../types';\n\ntype AlertInsightsSectionHeaderProps = {\n  alert: Alert;\n  number: number;\n};\n\nexport const AlertInsightsSectionHeader = ({\n  alert,\n  number,\n}: AlertInsightsSectionHeaderProps) => {\n  const classes = useStyles();\n\n  const isViewInstructionsButtonDisplayed = !!alert.url;\n\n  return (\n    <Box position=\"relative\" mb={3} textAlign=\"left\">\n      <ScrollAnchor id={`alert-${number}`} />\n      <Grid\n        container\n        spacing={2}\n        justifyContent=\"space-between\"\n        alignItems=\"center\"\n      >\n        <Grid item>\n          <Box display=\"flex\" alignItems=\"center\">\n            <Box mr={2}>\n              <Avatar className={classes.button}>{number}</Avatar>\n            </Box>\n            <Box>\n              <Typography variant=\"h5\">{alert.title}</Typography>\n              <Typography gutterBottom>{alert.subtitle}</Typography>\n            </Box>\n          </Box>\n        </Grid>\n        {isViewInstructionsButtonDisplayed && (\n          <Grid item>\n            <Button variant=\"text\" color=\"primary\" href={alert.url}>\n              {alert.buttonText || 'View Instructions'}\n            </Button>\n          </Grid>\n        )}\n      </Grid>\n    </Box>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from 'react';\nimport { Box, Button } from '@material-ui/core';\nimport { default as SnoozeIcon } from '@material-ui/icons/AccessTime';\nimport { default as AcceptIcon } from '@material-ui/icons/Check';\nimport { default as DismissIcon } from '@material-ui/icons/Delete';\nimport { AlertInsightsSectionHeader } from './AlertInsightsSectionHeader';\nimport { Alert } from '../../types';\nimport {\n  isSnoozeEnabled,\n  isAcceptEnabled,\n  isDismissEnabled,\n} from '../../utils/alerts';\n\ntype AlertInsightsSectionProps = {\n  alert: Alert;\n  number: number;\n  onSnooze: (alert: Alert) => void;\n  onAccept: (alert: Alert) => void;\n  onDismiss: (alert: Alert) => void;\n};\n\nexport const AlertInsightsSection = ({\n  alert,\n  number,\n  onSnooze,\n  onAccept,\n  onDismiss,\n}: AlertInsightsSectionProps) => {\n  const isSnoozeButtonDisplayed = isSnoozeEnabled(alert);\n  const isAcceptButtonDisplayed = isAcceptEnabled(alert);\n  const isDismissButtonDisplayed = isDismissEnabled(alert);\n  const isButtonGroupDisplayed =\n    isSnoozeButtonDisplayed ||\n    isAcceptButtonDisplayed ||\n    isDismissButtonDisplayed;\n\n  return (\n    <Box display=\"flex\" flexDirection=\"column\" mb={6}>\n      <AlertInsightsSectionHeader alert={alert} number={number} />\n      {isButtonGroupDisplayed && (\n        <Box display=\"flex\" alignItems=\"center\" mb={4}>\n          {isAcceptButtonDisplayed && (\n            <Box mr={1}>\n              <Button\n                color=\"primary\"\n                variant=\"contained\"\n                aria-label=\"accept\"\n                onClick={() => onAccept(alert)}\n                startIcon={<AcceptIcon />}\n              >\n                Accept\n              </Button>\n            </Box>\n          )}\n          {isSnoozeButtonDisplayed && (\n            <Box mr={1}>\n              <Button\n                color=\"default\"\n                variant=\"outlined\"\n                aria-label=\"snooze\"\n                disableElevation\n                onClick={() => onSnooze(alert)}\n                startIcon={<SnoozeIcon />}\n              >\n                Snooze\n              </Button>\n            </Box>\n          )}\n          {isDismissButtonDisplayed && (\n            <Button\n              color=\"secondary\"\n              variant=\"outlined\"\n              aria-label=\"dismiss\"\n              disableElevation\n              onClick={() => onDismiss(alert)}\n              startIcon={<DismissIcon />}\n            >\n              Dismiss\n            </Button>\n          )}\n        </Box>\n      )}\n      {alert.element}\n    </Box>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useState } from 'react';\nimport pluralize from 'pluralize';\nimport { Box, Grid, Snackbar } from '@material-ui/core';\nimport { default as MuiAlert } from '@material-ui/lab/Alert';\nimport { AlertDialog } from './AlertDialog';\nimport { AlertStatusSummary } from './AlertStatusSummary';\nimport { AlertStatusSummaryButton } from './AlertStatusSummaryButton';\nimport { AlertInsightsHeader } from './AlertInsightsHeader';\nimport { AlertInsightsSection } from './AlertInsightsSection';\nimport {\n  useScroll,\n  useLoading,\n  ScrollType,\n  MapLoadingToProps,\n} from '../../hooks';\nimport { DefaultLoadingAction } from '../../utils/loading';\nimport { Alert, AlertOptions, AlertStatus, Maybe } from '../../types';\nimport {\n  isStatusSnoozed,\n  isStatusAccepted,\n  isStatusDismissed,\n  sumOfAllAlerts,\n} from '../../utils/alerts';\nimport { ScrollAnchor } from '../../utils/scroll';\n\ntype MapLoadingtoAlerts = (isLoading: boolean) => void;\n\nconst mapLoadingToAlerts: MapLoadingToProps<MapLoadingtoAlerts> =\n  ({ dispatch }) =>\n  (isLoading: boolean) =>\n    dispatch({ [DefaultLoadingAction.CostInsightsAlerts]: isLoading });\n\ntype AlertInsightsProps = {\n  group: string;\n  active: Alert[];\n  snoozed: Alert[];\n  accepted: Alert[];\n  dismissed: Alert[];\n  onChange: (alerts: Alert[]) => void;\n};\n\nexport const AlertInsights = ({\n  group,\n  active,\n  snoozed,\n  accepted,\n  dismissed,\n  onChange,\n}: AlertInsightsProps) => {\n  const [scroll] = useScroll();\n  const [alert, setAlert] = useState<Maybe<Alert>>(null);\n  const dispatchLoadingAlerts = useLoading(mapLoadingToAlerts);\n  const [status, setStatus] = useState<Maybe<AlertStatus>>(null);\n  // Allow users to pass null values for data.\n  const [data, setData] = useState<Maybe<any>>(undefined);\n  const [error, setError] = useState<Maybe<Error>>(null);\n  const [isDialogOpen, setDialogOpen] = useState(false);\n  const [isSummaryOpen, setSummaryOpen] = useState(false);\n  const [isSnackbarOpen, setSnackbarOpen] = useState(false);\n\n  useEffect(() => {\n    async function callAlertHook(\n      options: AlertOptions,\n      callback: (options: AlertOptions) => Promise<Alert[]>,\n    ) {\n      setAlert(null);\n      setStatus(null);\n      setData(undefined);\n      setDialogOpen(false);\n      dispatchLoadingAlerts(true);\n      try {\n        const alerts: Alert[] = await callback(options);\n        onChange(alerts);\n      } catch (e) {\n        setError(e);\n      } finally {\n        dispatchLoadingAlerts(false);\n      }\n    }\n\n    const options: AlertOptions = { data, group };\n    const onSnoozed = alert?.onSnoozed?.bind(alert);\n    const onAccepted = alert?.onAccepted?.bind(alert);\n    const onDismissed = alert?.onDismissed?.bind(alert);\n\n    if (data !== undefined) {\n      if (isStatusSnoozed(status) && onSnoozed) {\n        callAlertHook(options, onSnoozed);\n      } else if (isStatusAccepted(status) && onAccepted) {\n        callAlertHook(options, onAccepted);\n      } else if (isStatusDismissed(status) && onDismissed) {\n        callAlertHook(options, onDismissed);\n      }\n    }\n  }, [group, data, alert, status, onChange, dispatchLoadingAlerts]);\n\n  useEffect(() => {\n    if (scroll === ScrollType.AlertSummary) {\n      setSummaryOpen(true);\n    }\n  }, [scroll]);\n\n  useEffect(() => {\n    setDialogOpen(!!status);\n  }, [status]);\n\n  useEffect(() => {\n    setSnackbarOpen(!!error);\n  }, [error]);\n\n  function onSnooze(alertToSnooze: Alert) {\n    setAlert(alertToSnooze);\n    setStatus(AlertStatus.Snoozed);\n  }\n\n  function onAccept(alertToAccept: Alert) {\n    setAlert(alertToAccept);\n    setStatus(AlertStatus.Accepted);\n  }\n\n  function onDismiss(alertToDismiss: Alert) {\n    setAlert(alertToDismiss);\n    setStatus(AlertStatus.Dismissed);\n  }\n\n  function onSnackbarClose() {\n    setError(null);\n  }\n\n  function onDialogClose() {\n    setAlert(null);\n    setStatus(null);\n  }\n\n  function onDialogFormSubmit(formData: any) {\n    setData(formData);\n  }\n\n  function onSummaryButtonClick() {\n    setSummaryOpen(prevOpen => !prevOpen);\n  }\n\n  const total = [accepted, snoozed, dismissed].reduce(sumOfAllAlerts, 0);\n\n  const isAlertStatusSummaryDisplayed = !!total;\n  const isAlertInsightSectionDisplayed = !!active.length;\n\n  return (\n    <Grid container direction=\"column\" spacing={2}>\n      <Grid item>\n        <AlertInsightsHeader\n          title=\"Your team's action items\"\n          subtitle={\n            isAlertInsightSectionDisplayed\n              ? 'This section outlines suggested action items your team can address to improve cloud costs.'\n              : \"All of your team's action items are hidden. Maybe it's time to give them another look?\"\n          }\n        />\n      </Grid>\n      {isAlertInsightSectionDisplayed && (\n        <Grid item container direction=\"column\" spacing={4}>\n          {active.map((activeAlert, index) => (\n            <Grid item key={`alert-insights-section-${index}`}>\n              <AlertInsightsSection\n                alert={activeAlert}\n                number={index + 1}\n                onSnooze={onSnooze}\n                onAccept={onAccept}\n                onDismiss={onDismiss}\n              />\n            </Grid>\n          ))}\n        </Grid>\n      )}\n      {isAlertStatusSummaryDisplayed && (\n        <Grid item>\n          <Box position=\"relative\" display=\"flex\" justifyContent=\"flex-end\">\n            <ScrollAnchor id={ScrollType.AlertSummary} />\n            <AlertStatusSummaryButton onClick={onSummaryButtonClick}>\n              {pluralize('Hidden Action Item', total)}\n            </AlertStatusSummaryButton>\n          </Box>\n          <AlertStatusSummary\n            open={isSummaryOpen}\n            snoozed={snoozed}\n            accepted={accepted}\n            dismissed={dismissed}\n          />\n        </Grid>\n      )}\n      <AlertDialog\n        group={group}\n        open={isDialogOpen}\n        alert={alert}\n        status={status}\n        onClose={onDialogClose}\n        onSubmit={onDialogFormSubmit}\n      />\n      <Snackbar\n        open={isSnackbarOpen}\n        autoHideDuration={6_000}\n        anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\n        onClose={onSnackbarClose}\n      >\n        <MuiAlert onClose={onSnackbarClose} severity=\"error\">\n          {error?.message}\n        </MuiAlert>\n      </Snackbar>\n    </Grid>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { useCopyToClipboard } from 'react-use';\nimport { Tooltip, IconButton } from '@material-ui/core';\nimport AssignmentOutlinedIcon from '@material-ui/icons/AssignmentOutlined';\nimport AssignmentTurnedInOutlinedIcon from '@material-ui/icons/AssignmentTurnedInOutlined';\nimport SentimentVeryDissatisfiedIcon from '@material-ui/icons/SentimentVeryDissatisfied';\n\nconst ClipboardMessage = {\n  default: 'Copy URL to clipboard',\n  success: 'Copied!',\n  error: \"Couldn't copy to clipboard\",\n};\n\nexport const CopyUrlToClipboard = () => {\n  const location = useLocation();\n  const [state, copyToClipboard] = useCopyToClipboard();\n  const [copied, setCopied] = useState(false);\n\n  const origin = window.location.origin;\n  const pathname = location.pathname;\n  const search = location.search;\n  const url = `${origin}${pathname}${search}`;\n\n  useEffect(() => {\n    if (state.error) {\n      setCopied(false);\n    } else if (state.value) {\n      setCopied(true);\n      setTimeout(setCopied, 1500, false);\n    }\n  }, [state]);\n\n  let text = ClipboardMessage.default;\n  let Icon = AssignmentOutlinedIcon;\n\n  if (state.error) {\n    text = ClipboardMessage.error;\n    Icon = SentimentVeryDissatisfiedIcon;\n  } else if (copied) {\n    text = ClipboardMessage.success;\n    Icon = AssignmentTurnedInOutlinedIcon;\n  }\n\n  return (\n    <Tooltip title={text} arrow>\n      <IconButton onClick={() => copyToClipboard(url)}>\n        <Icon />\n      </IconButton>\n    </Tooltip>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { Typography } from '@material-ui/core';\nimport { useCostInsightsStyles } from '../../utils/styles';\nimport { Group } from '../../types';\nimport {\n  identityApiRef,\n  ProfileInfo,\n  useApi,\n} from '@backstage/core-plugin-api';\n\nfunction name(profile: ProfileInfo | undefined): string {\n  return profile?.displayName || 'Mysterious Stranger';\n}\n\ntype CostInsightsHeaderProps = {\n  owner: string;\n  groups: Group[];\n  hasCostData: boolean;\n  alerts: number;\n};\n\nconst CostInsightsHeaderNoData = ({\n  owner,\n  groups,\n}: CostInsightsHeaderProps) => {\n  const profile = useApi(identityApiRef).getProfile();\n  const classes = useCostInsightsStyles();\n  const hasMultipleGroups = groups.length > 1;\n\n  return (\n    <>\n      <Typography variant=\"h4\" align=\"center\" gutterBottom>\n        <span role=\"img\" aria-label=\"flushed-face\">\n          üò≥\n        </span>{' '}\n        Well this is awkward\n      </Typography>\n      <Typography className={classes.h6Subtle} align=\"center\" gutterBottom>\n        <b>Hey, {name(profile)}!</b> <b>{owner}</b> doesn't seem to have any\n        cloud costs.\n      </Typography>\n      {hasMultipleGroups && (\n        <Typography align=\"center\" gutterBottom>\n          Maybe we picked the wrong team, choose another from the menu above?\n        </Typography>\n      )}\n    </>\n  );\n};\n\nconst CostInsightsHeaderAlerts = ({\n  owner,\n  alerts,\n}: CostInsightsHeaderProps) => {\n  const profile = useApi(identityApiRef).getProfile();\n  const classes = useCostInsightsStyles();\n\n  return (\n    <>\n      <Typography variant=\"h4\" align=\"center\" gutterBottom>\n        <span role=\"img\" aria-label=\"magnifying-glass\">\n          üîé\n        </span>{' '}\n        You have {alerts} thing{alerts > 1 && 's'} to look into\n      </Typography>\n      <Typography className={classes.h6Subtle} align=\"center\" gutterBottom>\n        <b>Hey, {name(profile)}!</b> We've identified{' '}\n        {alerts > 1 ? 'a few things ' : 'one thing '}\n        <b>{owner}</b> should look into next.\n      </Typography>\n    </>\n  );\n};\n\nconst CostInsightsHeaderNoAlerts = ({ owner }: CostInsightsHeaderProps) => {\n  const profile = useApi(identityApiRef).getProfile();\n  const classes = useCostInsightsStyles();\n\n  return (\n    <>\n      <Typography variant=\"h4\" gutterBottom align=\"center\">\n        <span role=\"img\" aria-label=\"thumbs-up\">\n          üëç\n        </span>{' '}\n        Your team is doing great\n      </Typography>\n      <Typography className={classes.h6Subtle} align=\"center\" gutterBottom>\n        <b>Hey, {name(profile)}!</b> <b>{owner}</b> is doing well. No major\n        changes this month.\n      </Typography>\n    </>\n  );\n};\n\nexport const CostInsightsHeaderNoGroups = () => {\n  const profile = useApi(identityApiRef).getProfile();\n  const classes = useCostInsightsStyles();\n  return (\n    <>\n      <Typography variant=\"h4\" align=\"center\" gutterBottom>\n        <span role=\"img\" aria-label=\"flushed-face\">\n          üò≥\n        </span>{' '}\n        Well this is awkward\n      </Typography>\n      <Typography className={classes.h6Subtle} align=\"center\" gutterBottom>\n        <b>Hey, {name(profile)}!</b> It doesn't look like you belong to any\n        teams.\n      </Typography>\n    </>\n  );\n};\n\nexport const CostInsightsHeader = (props: CostInsightsHeaderProps) => {\n  if (!props.hasCostData) {\n    return <CostInsightsHeaderNoData {...props} />;\n  }\n  if (props.alerts) {\n    return <CostInsightsHeaderAlerts {...props} />;\n  }\n  return <CostInsightsHeaderNoAlerts {...props} />;\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport {\n  InputLabel,\n  FormControl,\n  MenuItem,\n  Select,\n  SelectProps,\n} from '@material-ui/core';\nimport { Currency, CurrencyType } from '../../types';\nimport { findAlways } from '../../utils/assert';\nimport { useSelectStyles as useStyles } from '../../utils/styles';\n\nconst NULL_VALUE = 'engineers';\n\ntype CurrencySelectProps = {\n  currency: Currency;\n  currencies: Currency[];\n  onSelect: (currency: Currency) => void;\n};\n\nexport const CurrencySelect = ({\n  currency,\n  currencies,\n  onSelect,\n}: CurrencySelectProps) => {\n  const classes = useStyles();\n\n  const getOption = (value: unknown) => {\n    const kind = (value === NULL_VALUE ? null : value) as CurrencyType;\n    return findAlways(currencies, c => c.kind === kind);\n  };\n\n  const handleOnChange: SelectProps['onChange'] = e => {\n    const option = getOption(e.target.value);\n    onSelect(option);\n  };\n\n  const renderValue: SelectProps['renderValue'] = value => {\n    const option = getOption(value);\n    return <b>{option.label}</b>;\n  };\n\n  return (\n    <FormControl variant=\"outlined\">\n      <InputLabel shrink>Convert to:</InputLabel>\n      <Select\n        className={classes.select}\n        variant=\"outlined\"\n        labelWidth={100}\n        onChange={handleOnChange}\n        value={currency.kind || NULL_VALUE}\n        renderValue={renderValue}\n      >\n        {currencies.map((c: Currency) => (\n          <MenuItem\n            className={classes.menuItem}\n            key={c.kind || NULL_VALUE}\n            value={c.kind || NULL_VALUE}\n          >\n            <span role=\"img\" aria-label={c.label}>\n              {c.label}\n            </span>\n          </MenuItem>\n        ))}\n      </Select>\n    </FormControl>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { Typography, Box, Grid, Container, Divider } from '@material-ui/core';\n\nexport const WhyCostsMatter = () => {\n  return (\n    <Box mt={10} mb={4}>\n      <Container maxWidth=\"md\">\n        <Box mt={2} mb={2}>\n          <Typography variant=\"h5\" align=\"center\" gutterBottom>\n            Why cloud costs matter\n          </Typography>\n        </Box>\n        <Grid container alignContent=\"space-around\" spacing={3} wrap=\"nowrap\">\n          <Grid item>\n            <Typography variant=\"h6\">\n              Sustainability{' '}\n              <span role=\"img\" aria-label=\"globe\">\n                üåé\n              </span>\n            </Typography>\n            <Typography>\n              Reducing cloud usage improves our carbon footprint.\n            </Typography>\n          </Grid>\n          <Grid item>\n            <Divider orientation=\"vertical\" />\n          </Grid>\n          <Grid item>\n            <Typography variant=\"h6\">\n              Revenue{' '}\n              <span role=\"img\" aria-label=\"money-with-wings\">\n                üí∏\n              </span>\n            </Typography>\n            <Typography>\n              Keeping cloud costs well-tuned prevents infrastructure from eating\n              into revenue.\n            </Typography>\n          </Grid>\n          <Grid item>\n            <Divider orientation=\"vertical\" />\n          </Grid>\n          <Grid item>\n            <Typography variant=\"h6\">\n              Innovation{' '}\n              <span role=\"img\" aria-label=\"medal\">\n                ü•á\n              </span>\n            </Typography>\n            <Typography>\n              The more we save, the more we can reinvest in speed and\n              innovation.\n            </Typography>\n          </Grid>\n        </Grid>\n      </Container>\n    </Box>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DateAggregation, Trendline, ChartData } from '../types';\n\nexport function trendFrom(trendline: Trendline, date: number): number {\n  return trendline.slope * (date / 1000) + trendline.intercept;\n}\n\nexport function groupByDate(\n  acc: Record<string, number>,\n  entry: DateAggregation,\n): Record<string, number> {\n  return { ...acc, [entry.date]: entry.amount };\n}\n\nexport function toMaxCost(acc: ChartData, entry: ChartData): ChartData {\n  return acc.dailyCost > entry.dailyCost ? acc : entry;\n}\n\nexport function toDataMax(metric: string, data: ChartData[]): number {\n  return (\n    (data.reduce(toMaxCost).dailyCost / Math.abs(data[0].trend)) *\n    data[0][metric]\n  );\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Duration, Maybe, PageFilters } from '../../types';\nimport { MapFiltersToProps } from '../../hooks/useFilters';\n\ntype CostOverviewFilterProps = PageFilters & {\n  setDuration: (duration: Duration) => void;\n  setProject: (project: Maybe<string>) => void;\n  setMetric: (metric: Maybe<string>) => void;\n};\n\nexport const mapFiltersToProps: MapFiltersToProps<CostOverviewFilterProps> = ({\n  pageFilters,\n  setPageFilters,\n}) => ({\n  ...pageFilters,\n  project: pageFilters.project || 'all',\n  setDuration: (duration: Duration) =>\n    setPageFilters({\n      ...pageFilters,\n      duration,\n    }),\n  setProject: (project: Maybe<string>) =>\n    setPageFilters({\n      ...pageFilters,\n      project: project === 'all' ? null : project,\n    }),\n  setMetric: (metric: Maybe<string>) =>\n    setPageFilters({\n      ...pageFilters,\n      metric: metric,\n    }),\n});\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { PropsWithChildren } from 'react';\nimport { Box, useTheme } from '@material-ui/core';\nimport { LegendItem } from '../LegendItem';\nimport {\n  CostInsightsTheme,\n  MetricData,\n  Maybe,\n  Cost,\n  Metric,\n} from '../../types';\nimport { useLastCompleteBillingDate, useFilters } from '../../hooks';\nimport { getComparedChange, choose } from '../../utils/change';\nimport { mapFiltersToProps } from './selector';\nimport { formatChange } from '../../utils/formatters';\nimport { CostGrowth } from '../CostGrowth';\n\ntype CostOverviewLegendProps = {\n  metric: Maybe<Metric>;\n  metricData: Maybe<MetricData>;\n  dailyCostData: Cost;\n};\n\nexport const CostOverviewLegend = ({\n  dailyCostData,\n  metric,\n  metricData,\n}: PropsWithChildren<CostOverviewLegendProps>) => {\n  const theme = useTheme<CostInsightsTheme>();\n  const { duration } = useFilters(mapFiltersToProps);\n  const lastCompleteBillingDate = useLastCompleteBillingDate();\n\n  const comparedChange = metricData\n    ? getComparedChange(\n        dailyCostData,\n        metricData,\n        duration,\n        lastCompleteBillingDate,\n      )\n    : null;\n\n  return (\n    <Box display=\"flex\" flexDirection=\"row\">\n      {dailyCostData.change && (\n        <Box mr={2}>\n          <LegendItem title=\"Cost Trend\" markerColor={theme.palette.blue}>\n            {formatChange(dailyCostData.change)}\n          </LegendItem>\n        </Box>\n      )}\n      {metricData && metric && comparedChange && (\n        <>\n          <Box mr={2}>\n            <LegendItem\n              title={`${metric.name} Trend`}\n              markerColor={theme.palette.magenta}\n            >\n              {formatChange(metricData.change)}\n            </LegendItem>\n          </Box>\n          <LegendItem\n            title={choose(['Your Savings', 'Your Excess'], comparedChange)}\n          >\n            <CostGrowth change={comparedChange} duration={duration} />\n          </LegendItem>\n        </>\n      )}\n    </Box>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from 'react';\nimport { DateTime } from 'luxon';\nimport { useTheme, Box } from '@material-ui/core';\nimport {\n  ComposedChart,\n  ContentRenderer,\n  TooltipProps,\n  XAxis,\n  YAxis,\n  Tooltip as RechartsTooltip,\n  CartesianGrid,\n  Area,\n  Line,\n  ResponsiveContainer,\n} from 'recharts';\nimport {\n  ChartData,\n  Cost,\n  DEFAULT_DATE_FORMAT,\n  Maybe,\n  Metric,\n  MetricData,\n  CostInsightsTheme,\n} from '../../types';\nimport {\n  BarChartTooltip as Tooltip,\n  BarChartTooltipItem as TooltipItem,\n} from '../BarChart';\nimport {\n  overviewGraphTickFormatter,\n  formatGraphValue,\n  isInvalid,\n} from '../../utils/graphs';\nimport { useCostOverviewStyles as useStyles } from '../../utils/styles';\nimport { groupByDate, toDataMax, trendFrom } from '../../utils/charts';\nimport { aggregationSort } from '../../utils/sort';\nimport { CostOverviewLegend } from './CostOverviewLegend';\n\ntype CostOverviewChartProps = {\n  metric: Maybe<Metric>;\n  metricData: Maybe<MetricData>;\n  dailyCostData: Cost;\n  responsive?: boolean;\n};\n\nexport const CostOverviewChart = ({\n  dailyCostData,\n  metric,\n  metricData,\n  responsive = true,\n}: CostOverviewChartProps) => {\n  const theme = useTheme<CostInsightsTheme>();\n  const styles = useStyles(theme);\n\n  const data = {\n    dailyCost: {\n      dataKey: 'dailyCost',\n      name: `Daily Cost`,\n      format: 'currency',\n      data: dailyCostData,\n    },\n    metric: {\n      dataKey: metric?.kind ?? 'Unknown',\n      name: metric?.name ?? 'Unknown',\n      format: metricData?.format ?? 'number',\n      data: metricData,\n    },\n  };\n\n  const metricsByDate = data.metric.data\n    ? data.metric.data.aggregation.reduce(groupByDate, {})\n    : {};\n\n  const chartData: ChartData[] = data.dailyCost.data.aggregation\n    .slice()\n    .sort(aggregationSort)\n    .map(entry => ({\n      date: Date.parse(entry.date),\n      trend: trendFrom(data.dailyCost.data.trendline!, Date.parse(entry.date)),\n      dailyCost: entry.amount,\n      ...(metric && data.metric.data\n        ? { [data.metric.dataKey]: metricsByDate[`${entry.date}`] }\n        : {}),\n    }));\n\n  const tooltipRenderer: ContentRenderer<TooltipProps> = ({\n    label,\n    payload = [],\n  }) => {\n    if (isInvalid({ label, payload })) return null;\n\n    const dataKeys = [data.dailyCost.dataKey, data.metric.dataKey];\n    const date =\n      typeof label === 'number'\n        ? DateTime.fromMillis(label)\n        : DateTime.fromISO(label!);\n    const title = date.toUTC().toFormat(DEFAULT_DATE_FORMAT);\n    const items = payload\n      .filter(p => dataKeys.includes(p.dataKey as string))\n      .map(p => ({\n        label:\n          p.dataKey === data.dailyCost.dataKey\n            ? data.dailyCost.name\n            : data.metric.name,\n        value:\n          p.dataKey === data.dailyCost.dataKey\n            ? formatGraphValue(p.value as number, data.dailyCost.format)\n            : formatGraphValue(p.value as number, data.metric.format),\n        fill:\n          p.dataKey === data.dailyCost.dataKey\n            ? theme.palette.blue\n            : theme.palette.magenta,\n      }));\n\n    return (\n      <Tooltip title={title}>\n        {items.map((item, index) => (\n          <TooltipItem key={`${item.label}-${index}`} item={item} />\n        ))}\n      </Tooltip>\n    );\n  };\n\n  return (\n    <Box display=\"flex\" flexDirection=\"column\">\n      <CostOverviewLegend\n        dailyCostData={dailyCostData}\n        metric={metric}\n        metricData={metricData}\n      />\n      <ResponsiveContainer\n        width={responsive ? '100%' : styles.container.width}\n        height={styles.container.height}\n        className=\"cost-overview-chart\"\n      >\n        <ComposedChart margin={styles.chart.margin} data={chartData}>\n          <CartesianGrid stroke={styles.cartesianGrid.stroke} />\n          <XAxis\n            dataKey=\"date\"\n            domain={['dataMin', 'dataMax']}\n            tickFormatter={overviewGraphTickFormatter}\n            tickCount={6}\n            type=\"number\"\n            stroke={styles.axis.fill}\n          />\n          <YAxis\n            domain={[() => 0, 'dataMax']}\n            tick={{ fill: styles.axis.fill }}\n            tickFormatter={formatGraphValue}\n            width={styles.yAxis.width}\n            yAxisId={data.dailyCost.dataKey}\n          />\n          {metric && (\n            <YAxis\n              hide\n              domain={[() => 0, toDataMax(data.metric.dataKey, chartData)]}\n              width={styles.yAxis.width}\n              yAxisId={data.metric.dataKey}\n            />\n          )}\n          <Area\n            dataKey={data.dailyCost.dataKey}\n            isAnimationActive={false}\n            fill={theme.palette.blue}\n            fillOpacity={0.4}\n            stroke=\"none\"\n            yAxisId={data.dailyCost.dataKey}\n          />\n          <Line\n            activeDot={false}\n            dataKey=\"trend\"\n            dot={false}\n            isAnimationActive={false}\n            label={false}\n            strokeWidth={2}\n            stroke={theme.palette.blue}\n            yAxisId={data.dailyCost.dataKey}\n          />\n          {metric && (\n            <Line\n              dataKey={data.metric.dataKey}\n              dot={false}\n              isAnimationActive={false}\n              label={false}\n              strokeWidth={2}\n              stroke={theme.palette.magenta}\n              yAxisId={data.metric.dataKey}\n            />\n          )}\n          <RechartsTooltip content={tooltipRenderer} animationDuration={100} />\n        </ComposedChart>\n      </ResponsiveContainer>\n    </Box>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DateAggregation } from '../types';\n\nexport const aggregationSum = (aggregation: DateAggregation[]) =>\n  aggregation.reduce((total, curAgg) => total + curAgg.amount, 0);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, { useState } from 'react';\nimport { DateTime } from 'luxon';\nimport {\n  useTheme,\n  Box,\n  Typography,\n  Divider,\n  emphasize,\n} from '@material-ui/core';\nimport { default as FullScreenIcon } from '@material-ui/icons/Fullscreen';\nimport {\n  AreaChart,\n  ContentRenderer,\n  TooltipProps,\n  XAxis,\n  YAxis,\n  Tooltip as RechartsTooltip,\n  Area,\n  ResponsiveContainer,\n  CartesianGrid,\n} from 'recharts';\nimport { Cost, DEFAULT_DATE_FORMAT, CostInsightsTheme } from '../../types';\nimport {\n  BarChartTooltip as Tooltip,\n  BarChartTooltipItem as TooltipItem,\n  BarChartLegend,\n} from '../BarChart';\nimport {\n  overviewGraphTickFormatter,\n  formatGraphValue,\n  isInvalid,\n} from '../../utils/graphs';\nimport { useCostOverviewStyles as useStyles } from '../../utils/styles';\nimport { useFilters, useLastCompleteBillingDate } from '../../hooks';\nimport { mapFiltersToProps } from './selector';\nimport { getPreviousPeriodTotalCost } from '../../utils/change';\nimport { formatPeriod } from '../../utils/formatters';\nimport { aggregationSum } from '../../utils/sum';\nimport { BarChartLegendOptions } from '../BarChart/BarChartLegend';\n\nexport type CostOverviewBreakdownChartProps = {\n  costBreakdown: Cost[];\n};\n\nconst LOW_COST_THRESHOLD = 0.1;\n\nexport const CostOverviewBreakdownChart = ({\n  costBreakdown,\n}: CostOverviewBreakdownChartProps) => {\n  const theme = useTheme<CostInsightsTheme>();\n  const classes = useStyles(theme);\n  const lastCompleteBillingDate = useLastCompleteBillingDate();\n  const { duration } = useFilters(mapFiltersToProps);\n  const [isExpanded, setExpanded] = useState(false);\n\n  if (!costBreakdown) {\n    return null;\n  }\n\n  const flattenedAggregation = costBreakdown\n    .map(cost => cost.aggregation)\n    .flat();\n\n  const totalCost = aggregationSum(flattenedAggregation);\n\n  const previousPeriodTotal = getPreviousPeriodTotalCost(\n    flattenedAggregation,\n    duration,\n    lastCompleteBillingDate,\n  );\n  const currentPeriodTotal = totalCost - previousPeriodTotal;\n  const canExpand = costBreakdown.length >= 8;\n  const otherCategoryIds: string[] = [];\n\n  const breakdownsByDate = costBreakdown.reduce(\n    (breakdownByDate, breakdown) => {\n      const breakdownTotal = aggregationSum(breakdown.aggregation);\n      // Group breakdown items with less than 10% of the total cost into \"Other\" category if needed\n      const isOtherCategory =\n        canExpand && breakdownTotal < totalCost * LOW_COST_THRESHOLD;\n\n      const updatedBreakdownByDate = { ...breakdownByDate };\n      if (isOtherCategory) {\n        otherCategoryIds.push(breakdown.id);\n      }\n      breakdown.aggregation.forEach(curAggregation => {\n        const costsForDate = updatedBreakdownByDate[curAggregation.date] || {};\n\n        updatedBreakdownByDate[curAggregation.date] = {\n          ...costsForDate,\n          [breakdown.id]:\n            (costsForDate[breakdown.id] || 0) + curAggregation.amount,\n        };\n      });\n\n      return updatedBreakdownByDate;\n    },\n    {} as Record<string, Record<string, number>>,\n  );\n\n  const chartData: Record<string, number>[] = Object.keys(breakdownsByDate).map(\n    date => {\n      const costsForDate = Object.keys(breakdownsByDate[date]).reduce(\n        (dateCosts, breakdown) => {\n          // Group costs for items that belong to 'Other' in the chart.\n          const cost = breakdownsByDate[date][breakdown];\n          const breakdownCost =\n            !isExpanded && otherCategoryIds.includes(breakdown)\n              ? { Other: (dateCosts.Other || 0) + cost }\n              : { [breakdown]: cost };\n          return { ...dateCosts, ...breakdownCost };\n        },\n        {} as Record<string, number>,\n      );\n      return {\n        ...costsForDate,\n        date: Date.parse(date),\n      };\n    },\n  );\n\n  const sortedBreakdowns = costBreakdown.sort(\n    (a, b) => aggregationSum(a.aggregation) - aggregationSum(b.aggregation),\n  );\n\n  const renderAreas = () => {\n    const separatedBreakdowns = sortedBreakdowns\n      // Check that the breakdown is a separate group and hasn't been added to 'Other'\n      .filter(\n        breakdown =>\n          breakdown.id !== 'Other' && !otherCategoryIds.includes(breakdown.id),\n      )\n      .map(breakdown => breakdown.id);\n    // Keep 'Other' category at the bottom of the stack\n    const breakdownsToDisplay = isExpanded\n      ? sortedBreakdowns.map(breakdown => breakdown.id)\n      : ['Other', ...separatedBreakdowns];\n\n    return breakdownsToDisplay.map((breakdown, i) => {\n      // Logic to handle case where there are more items than data viz colors.\n      const color =\n        theme.palette.dataViz[\n          (breakdownsToDisplay.length - 1 - i) %\n            (theme.palette.dataViz.length - 1)\n        ];\n      return (\n        <Area\n          key={breakdown}\n          dataKey={breakdown}\n          isAnimationActive={false}\n          stackId=\"1\"\n          stroke={color}\n          fill={color}\n          onClick={() => setExpanded(true)}\n          style={{\n            cursor: breakdown === 'Other' && !isExpanded ? 'pointer' : null,\n          }}\n        />\n      );\n    });\n  };\n\n  const tooltipRenderer: ContentRenderer<TooltipProps> = ({\n    label,\n    payload = [],\n  }) => {\n    if (isInvalid({ label, payload })) return null;\n\n    const date =\n      typeof label === 'number'\n        ? DateTime.fromMillis(label)\n        : DateTime.fromISO(label!);\n    const dateTitle = date.toUTC().toFormat(DEFAULT_DATE_FORMAT);\n    const items = payload.map(p => ({\n      label: p.dataKey as string,\n      value: formatGraphValue(p.value as number),\n      fill: p.fill!,\n    }));\n    const expandText = (\n      <Box>\n        <Divider\n          style={{\n            backgroundColor: emphasize(theme.palette.divider, 1),\n            margin: '10px 0',\n          }}\n        />\n        <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\n          <FullScreenIcon />\n          <Typography>Click to expand</Typography>\n        </Box>\n      </Box>\n    );\n    return (\n      <Tooltip title={dateTitle}>\n        {items.reverse().map((item, index) => (\n          <TooltipItem key={`${item.label}-${index}`} item={item} />\n        ))}\n        {canExpand && !isExpanded ? expandText : null}\n      </Tooltip>\n    );\n  };\n\n  const options: Partial<BarChartLegendOptions> = {\n    previousName: formatPeriod(duration, lastCompleteBillingDate, false),\n    currentName: formatPeriod(duration, lastCompleteBillingDate, true),\n    hideMarker: true,\n  };\n\n  return (\n    <Box display=\"flex\" flexDirection=\"column\">\n      <Box display=\"flex\" flexDirection=\"row\">\n        <BarChartLegend\n          costStart={previousPeriodTotal}\n          costEnd={currentPeriodTotal}\n          options={options}\n        />\n      </Box>\n      <ResponsiveContainer\n        width={classes.container.width}\n        height={classes.container.height}\n      >\n        <AreaChart\n          data={chartData}\n          margin={{\n            top: 16,\n            right: 30,\n            bottom: 40,\n          }}\n        >\n          <CartesianGrid stroke={classes.cartesianGrid.stroke} />\n          <XAxis\n            dataKey=\"date\"\n            domain={['dataMin', 'dataMax']}\n            tickFormatter={overviewGraphTickFormatter}\n            tickCount={6}\n            type=\"number\"\n            stroke={classes.axis.fill}\n          />\n          <YAxis\n            domain={[() => 0, 'dataMax']}\n            tick={{ fill: classes.axis.fill }}\n            tickFormatter={formatGraphValue}\n            width={classes.yAxis.width}\n          />\n          {renderAreas()}\n          <RechartsTooltip content={tooltipRenderer} animationDuration={100} />\n        </AreaChart>\n      </ResponsiveContainer>\n    </Box>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, { PropsWithChildren } from 'react';\nimport { Box, Typography } from '@material-ui/core';\n\ntype CostOverviewHeaderProps = {\n  title: string;\n  subtitle?: string;\n};\n\nexport const CostOverviewHeader = ({\n  title,\n  subtitle,\n  children,\n}: PropsWithChildren<CostOverviewHeaderProps>) => (\n  <Box\n    mt={2}\n    ml={1}\n    mb={1}\n    display=\"flex\"\n    flexDirection=\"row\"\n    justifyContent=\"space-between\"\n    alignItems=\"center\"\n  >\n    <Box minHeight={40} paddingRight={5}>\n      <Typography variant=\"h5\" gutterBottom>\n        {title}\n      </Typography>\n      {!!subtitle && (\n        <Typography variant=\"subtitle2\" color=\"textSecondary\" component=\"div\">\n          {subtitle}\n        </Typography>\n      )}\n    </Box>\n    <Box minHeight={40} maxHeight={60} display=\"flex\">\n      {children}\n    </Box>\n  </Box>\n);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { InputLabel, FormControl, Select, MenuItem } from '@material-ui/core';\nimport { Maybe, Metric } from '../../types';\nimport { useSelectStyles as useStyles } from '../../utils/styles';\n\nexport type MetricSelectProps = {\n  metric: Maybe<string>;\n  metrics: Array<Metric>;\n  onSelect: (metric: Maybe<string>) => void;\n};\n\nexport const MetricSelect = ({\n  metric,\n  metrics,\n  onSelect,\n}: MetricSelectProps) => {\n  const classes = useStyles();\n\n  function onChange(e: React.ChangeEvent<{ value: unknown }>) {\n    if (e.target.value === 'none') {\n      onSelect(null);\n    } else {\n      onSelect(e.target.value as string);\n    }\n  }\n\n  return (\n    <FormControl variant=\"outlined\">\n      <InputLabel shrink id=\"metric-select-label\">\n        Compare to:\n      </InputLabel>\n      <Select\n        id=\"metric-select\"\n        labelId=\"metric-select-label\"\n        labelWidth={100}\n        className={classes.select}\n        value={metric ?? 'none'}\n        onChange={onChange}\n      >\n        <MenuItem className={classes.menuItem} key=\"none\" value=\"none\">\n          <em>None</em>\n        </MenuItem>\n        {metrics.map((m: Metric) => (\n          <MenuItem className={classes.menuItem} key={m.kind} value={m.kind}>\n            <b>{m.name}</b>\n          </MenuItem>\n        ))}\n      </Select>\n    </FormControl>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { MenuItem, Select, SelectProps } from '@material-ui/core';\nimport { Duration } from '../../types';\nimport { formatLastTwoLookaheadQuarters } from '../../utils/formatters';\nimport { findAlways } from '../../utils/assert';\nimport { useSelectStyles as useStyles } from '../../utils/styles';\nimport { useLastCompleteBillingDate } from '../../hooks';\n\nexport type PeriodOption = {\n  value: Duration;\n  label: string;\n};\n\nexport function getDefaultOptions(\n  lastCompleteBillingDate: string,\n): PeriodOption[] {\n  return [\n    {\n      value: Duration.P90D,\n      label: 'Past 6 Months',\n    },\n    {\n      value: Duration.P30D,\n      label: 'Past 60 Days',\n    },\n    {\n      value: Duration.P3M,\n      label: formatLastTwoLookaheadQuarters(lastCompleteBillingDate),\n    },\n  ];\n}\n\ntype PeriodSelectProps = {\n  duration: Duration;\n  onSelect: (duration: Duration) => void;\n  options?: PeriodOption[];\n};\n\nexport const PeriodSelect = ({\n  duration,\n  onSelect,\n  options,\n}: PeriodSelectProps) => {\n  const classes = useStyles();\n  const lastCompleteBillingDate = useLastCompleteBillingDate();\n  const optionsOrDefault =\n    options ?? getDefaultOptions(lastCompleteBillingDate);\n\n  const handleOnChange: SelectProps['onChange'] = e => {\n    onSelect(e.target.value as Duration);\n  };\n\n  const renderValue: SelectProps['renderValue'] = value => {\n    const option = findAlways(optionsOrDefault, o => o.value === value);\n    return <b>{option.label}</b>;\n  };\n\n  return (\n    <Select\n      className={classes.select}\n      variant=\"outlined\"\n      onChange={handleOnChange}\n      value={duration}\n      renderValue={renderValue}\n      data-testid=\"period-select\"\n    >\n      {optionsOrDefault.map(option => (\n        <MenuItem\n          className={classes.menuItem}\n          key={option.value}\n          value={option.value}\n          data-testid={`period-select-option-${option.value}`}\n        >\n          {option.label}\n        </MenuItem>\n      ))}\n    </Select>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect, useState } from 'react';\nimport {\n  Box,\n  capitalize,\n  Card,\n  CardContent,\n  Divider,\n  Tab,\n  Tabs,\n  useTheme,\n} from '@material-ui/core';\nimport { CostOverviewChart } from './CostOverviewChart';\nimport { CostOverviewBreakdownChart } from './CostOverviewBreakdownChart';\nimport { CostOverviewHeader } from './CostOverviewHeader';\nimport { MetricSelect } from '../MetricSelect';\nimport { PeriodSelect } from '../PeriodSelect';\nimport { useConfig, useFilters } from '../../hooks';\nimport { mapFiltersToProps } from './selector';\nimport { DefaultNavigation } from '../../utils/navigation';\nimport { findAlways } from '../../utils/assert';\nimport { Cost, CostInsightsTheme, Maybe, MetricData } from '../../types';\nimport { useOverviewTabsStyles } from '../../utils/styles';\nimport { ScrollAnchor } from '../../utils/scroll';\n\nexport type CostOverviewCardProps = {\n  dailyCostData: Cost;\n  metricData: Maybe<MetricData>;\n};\n\nexport const CostOverviewCard = ({\n  dailyCostData,\n  metricData,\n}: CostOverviewCardProps) => {\n  const theme = useTheme<CostInsightsTheme>();\n  const styles = useOverviewTabsStyles(theme);\n  const config = useConfig();\n  const [tabIndex, setTabIndex] = useState(0);\n  const { setDuration, setProject, setMetric, ...filters } =\n    useFilters(mapFiltersToProps);\n\n  // Reset tabIndex if breakdowns available change\n  useEffect(() => {\n    // Intentionally off-by-one to account for the overview tab\n    const lastIndex = Object.keys(dailyCostData.groupedCosts ?? {}).length;\n    if (tabIndex > lastIndex) {\n      setTabIndex(0);\n    }\n  }, [dailyCostData, tabIndex, setTabIndex]);\n\n  const metric = filters.metric\n    ? findAlways(config.metrics, m => m.kind === filters.metric)\n    : null;\n\n  const breakdownTabs = Object.keys(dailyCostData.groupedCosts ?? {}).map(\n    key => ({\n      id: key,\n      label: `Breakdown by ${key}`,\n      title: `Cloud Cost By ${capitalize(key)}`,\n    }),\n  );\n  const tabs = [\n    { id: 'overview', label: 'Total cost', title: 'Cloud Cost' },\n  ].concat(breakdownTabs);\n  // tabIndex can temporarily be invalid while the useEffect above processes\n  const safeTabIndex = tabIndex > tabs.length - 1 ? 0 : tabIndex;\n\n  const OverviewTabs = () => {\n    return (\n      <>\n        <Tabs\n          indicatorColor=\"primary\"\n          onChange={(_, index) => setTabIndex(index)}\n          value={safeTabIndex}\n        >\n          {tabs.map((tab, index) => (\n            <Tab\n              className={styles.default}\n              label={tab.label}\n              key={tab.id}\n              value={index}\n              classes={{ selected: styles.selected }}\n            />\n          ))}\n        </Tabs>\n      </>\n    );\n  };\n\n  // Metrics can only be selected on the total cost graph\n  const showMetricSelect = config.metrics.length && safeTabIndex === 0;\n\n  return (\n    <Card style={{ position: 'relative' }}>\n      <ScrollAnchor id={DefaultNavigation.CostOverviewCard} />\n      <CardContent>\n        {dailyCostData.groupedCosts && <OverviewTabs />}\n        <CostOverviewHeader title={tabs[safeTabIndex].title}>\n          <PeriodSelect duration={filters.duration} onSelect={setDuration} />\n        </CostOverviewHeader>\n        <Divider />\n        <Box ml={2} my={1} display=\"flex\" flexDirection=\"column\">\n          {safeTabIndex === 0 ? (\n            <CostOverviewChart\n              dailyCostData={dailyCostData}\n              metric={metric}\n              metricData={metricData}\n            />\n          ) : (\n            <CostOverviewBreakdownChart\n              costBreakdown={dailyCostData.groupedCosts![tabs[safeTabIndex].id]}\n            />\n          )}\n        </Box>\n        <Box display=\"flex\" justifyContent=\"flex-end\" alignItems=\"center\">\n          {showMetricSelect && (\n            <MetricSelect\n              metric={filters.metric}\n              metrics={config.metrics}\n              onSelect={setMetric}\n            />\n          )}\n        </Box>\n      </CardContent>\n    </Card>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  PropsWithChildren,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport pluralize from 'pluralize';\nimport { Typography } from '@material-ui/core';\nimport { default as Alert } from '@material-ui/lab/Alert';\nimport { PeriodSelect } from '../PeriodSelect';\nimport { ProductInsightsChart } from './ProductInsightsChart';\nimport { useProductInsightsCardStyles as useStyles } from '../../utils/styles';\nimport { DefaultLoadingAction } from '../../utils/loading';\nimport { Duration, Entity, Maybe, Product } from '../../types';\nimport {\n  MapLoadingToProps,\n  useLastCompleteBillingDate,\n  useLoading,\n} from '../../hooks';\nimport { findAnyKey } from '../../utils/assert';\nimport { ScrollAnchor } from '../../utils/scroll';\nimport { InfoCard } from '@backstage/core-components';\n\ntype LoadingProps = (isLoading: boolean) => void;\n\nexport type ProductInsightsCardProps = {\n  product: Product;\n  initialState: {\n    entity: Maybe<Entity>;\n    duration: Duration;\n  };\n  onSelectAsync: (product: Product, duration: Duration) => Promise<Entity>;\n};\n\nconst mapLoadingToProps: MapLoadingToProps<LoadingProps> =\n  ({ dispatch }) =>\n  (isLoading: boolean) =>\n    dispatch({ [DefaultLoadingAction.CostInsightsProducts]: isLoading });\n\nexport const ProductInsightsCard = ({\n  initialState,\n  product,\n  onSelectAsync,\n}: PropsWithChildren<ProductInsightsCardProps>) => {\n  const classes = useStyles();\n  const mountedRef = useRef(false);\n  const [error, setError] = useState<Maybe<Error>>(null);\n  const dispatchLoading = useLoading(mapLoadingToProps);\n  const lastCompleteBillingDate = useLastCompleteBillingDate();\n  const [entity, setEntity] = useState<Maybe<Entity>>(initialState.entity);\n  const [duration, setDuration] = useState<Duration>(initialState.duration);\n\n  /* eslint-disable react-hooks/exhaustive-deps */\n  const dispatchLoadingProduct = useCallback(dispatchLoading, []);\n  /* eslint-enable react-hooks/exhaustive-deps */\n\n  useEffect(() => {\n    async function handleOnSelectAsync() {\n      dispatchLoadingProduct(true);\n      try {\n        const e = await onSelectAsync(product, duration);\n        setEntity(e);\n      } catch (e) {\n        setEntity(null);\n        setError(e);\n      } finally {\n        dispatchLoadingProduct(false);\n      }\n    }\n\n    if (mountedRef.current) {\n      handleOnSelectAsync();\n    } else {\n      mountedRef.current = true;\n    }\n  }, [product, duration, onSelectAsync, dispatchLoadingProduct]);\n\n  // Only a single entities Record for the root product entity is supported\n  const entityKey = findAnyKey(entity?.entities);\n  const entities = entityKey ? entity!.entities[entityKey] : [];\n\n  const subheader =\n    entityKey && entities.length\n      ? `${pluralize(entityKey, entities.length, true)}, sorted by cost`\n      : null;\n  const headerProps = {\n    classes: classes,\n    action: <PeriodSelect duration={duration} onSelect={setDuration} />,\n  };\n\n  if (error || !entity) {\n    return (\n      <InfoCard title={product.name} headerProps={headerProps}>\n        <ScrollAnchor id={product.kind} />\n        <Alert severity=\"error\">\n          {error\n            ? error.message\n            : `Error: Could not fetch product insights for ${product.name}`}\n        </Alert>\n      </InfoCard>\n    );\n  }\n\n  return (\n    <InfoCard\n      title={product.name}\n      subheader={subheader}\n      headerProps={headerProps}\n    >\n      <ScrollAnchor id={product.kind} />\n      {entities.length ? (\n        <ProductInsightsChart\n          entity={entity}\n          duration={duration}\n          billingDate={lastCompleteBillingDate}\n        />\n      ) : (\n        <Typography>\n          There are no {product.name} costs within this time frame for your\n          team's projects.\n        </Typography>\n      )}\n    </InfoCard>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { Box, CircularProgress, Collapse } from '@material-ui/core';\nimport { ProductInsightsCard } from './ProductInsightsCard';\nimport { Duration, Entity, Product } from '../../types';\nimport { ProductState } from '../../utils/loading';\n\ntype ProductInsightsCardListProps = {\n  initialStates: ProductState[];\n  onSelectAsync: (product: Product, duration: Duration) => Promise<Entity>;\n};\n\nexport const ProductInsightsCardList = ({\n  initialStates,\n  onSelectAsync,\n}: ProductInsightsCardListProps) => {\n  if (!initialStates.length) {\n    return (\n      <Box display=\"flex\" justifyContent=\"space-around\" alignItems=\"center\">\n        <CircularProgress />\n      </Box>\n    );\n  }\n\n  return (\n    <Collapse in timeout={1000}>\n      {initialStates.map(({ product, entity, duration }) => (\n        <Box\n          key={product.kind}\n          mb={6}\n          position=\"relative\"\n          data-testid={`product-list-item-${product.kind}`}\n        >\n          <ProductInsightsCard\n            product={product}\n            onSelectAsync={onSelectAsync}\n            initialState={{ entity: entity, duration: duration }}\n          />\n        </Box>\n      ))}\n    </Collapse>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { Box, Typography } from '@material-ui/core';\nimport { default as Alert } from '@material-ui/lab/Alert';\nimport { costInsightsApiRef } from '../../api';\nimport { ProductInsightsCardList } from '../ProductInsightsCard/ProductInsightsCardList';\nimport { Duration, Entity, Maybe, Product } from '../../types';\nimport { intervalsOf, DEFAULT_DURATION } from '../../utils/duration';\nimport {\n  DefaultLoadingAction,\n  initialStatesOf,\n  settledResponseOf,\n  ProductState,\n} from '../../utils/loading';\nimport { totalAggregationSort } from '../../utils/sort';\nimport {\n  useLoading,\n  useLastCompleteBillingDate,\n  MapLoadingToProps,\n} from '../../hooks';\nimport { useApi } from '@backstage/core-plugin-api';\n\ntype LoadingProps = (isLoading: boolean) => void;\n\nconst mapLoadingToProps: MapLoadingToProps<LoadingProps> =\n  ({ dispatch }) =>\n  (isLoading: boolean) =>\n    dispatch({ [DefaultLoadingAction.CostInsightsProducts]: isLoading });\n\ntype ProductInsightsProps = {\n  group: string;\n  project: Maybe<string>;\n  products: Product[];\n  onLoaded: (entities: Product[]) => void;\n};\n\nexport const ProductInsights = ({\n  group,\n  project,\n  products,\n  onLoaded,\n}: ProductInsightsProps) => {\n  const client = useApi(costInsightsApiRef);\n  const onceRef = useRef(false);\n  const [initialStates, setStates] = useState<ProductState[]>([]);\n  const [error, setError] = useState<Maybe<Error>>(null);\n  const lastCompleteBillingDate = useLastCompleteBillingDate();\n  const dispatchLoading = useLoading(mapLoadingToProps);\n\n  /* eslint-disable react-hooks/exhaustive-deps */\n  // See @CostInsightsPage\n  const dispatchLoadingProducts = useCallback(dispatchLoading, []);\n  /* eslint-enable react-hooks/exhaustive-deps */\n\n  const onSelectAsyncMemo = useCallback(\n    async function onSelectAsync(\n      product: Product,\n      duration: Duration,\n    ): Promise<Entity> {\n      return client.getProductInsights({\n        group: group,\n        project: project,\n        product: product.kind,\n        intervals: intervalsOf(duration, lastCompleteBillingDate),\n      });\n    },\n    [client, group, project, lastCompleteBillingDate],\n  );\n\n  useEffect(() => {\n    async function getAllProductInsights() {\n      try {\n        dispatchLoadingProducts(true);\n        const responses = await Promise.allSettled(\n          products.map(product =>\n            client.getProductInsights({\n              group: group,\n              project: project,\n              product: product.kind,\n              intervals: intervalsOf(DEFAULT_DURATION, lastCompleteBillingDate),\n            }),\n          ),\n        ).then(settledResponseOf);\n\n        const updatedInitialStates = initialStatesOf(products, responses).sort(\n          totalAggregationSort,\n        );\n        setStates(updatedInitialStates);\n      } catch (e) {\n        setError(e);\n      } finally {\n        dispatchLoadingProducts(false);\n      }\n    }\n\n    getAllProductInsights();\n  }, [\n    client,\n    group,\n    project,\n    products,\n    lastCompleteBillingDate,\n    dispatchLoadingProducts,\n  ]);\n\n  useEffect(\n    function handleOnLoaded() {\n      if (onceRef.current) {\n        const initialProducts = initialStates.map(state => state.product);\n        onLoaded(initialProducts);\n      } else {\n        onceRef.current = true;\n      }\n    },\n    [initialStates, onLoaded],\n  );\n\n  return (\n    <Box px={3} py={6}>\n      <Box mt={0} mb={5} textAlign=\"center\">\n        <Typography variant=\"h4\" gutterBottom>\n          Your team's product usage\n        </Typography>\n      </Box>\n      {error ? (\n        <Alert severity=\"error\">{error.message}</Alert>\n      ) : (\n        <ProductInsightsCardList\n          initialStates={initialStates}\n          onSelectAsync={onSelectAsyncMemo}\n        />\n      )}\n    </Box>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { MapLoadingToProps } from '../../hooks';\nimport {\n  getResetState,\n  DefaultLoadingAction,\n  getResetStateWithoutInitial,\n} from '../../utils/loading';\n\ntype CostInsightsPageLoadingProps = {\n  loadingActions: Array<string>;\n  loadingGroups: boolean;\n  loadingBillingDate: boolean;\n  loadingInitial: boolean;\n  dispatchInitial: (isLoading: boolean) => void;\n  dispatchInsights: (isLoading: boolean) => void;\n  dispatchNone: (loadingActions: string[]) => void;\n  dispatchReset: (loadingActions: string[]) => void;\n};\n\nexport const mapLoadingToProps: MapLoadingToProps<CostInsightsPageLoadingProps> =\n  ({ state, actions, dispatch }) => ({\n    loadingActions: actions,\n    loadingGroups: state[DefaultLoadingAction.UserGroups],\n    loadingBillingDate: state[DefaultLoadingAction.LastCompleteBillingDate],\n    loadingInitial: state[DefaultLoadingAction.CostInsightsInitial],\n    dispatchInitial: (isLoading: boolean) =>\n      dispatch({ [DefaultLoadingAction.CostInsightsInitial]: isLoading }),\n    dispatchInsights: (isLoading: boolean) =>\n      dispatch({ [DefaultLoadingAction.CostInsightsPage]: isLoading }),\n    dispatchNone: (loadingActions: string[]) =>\n      dispatch(getResetState(loadingActions)),\n    dispatchReset: (loadingActions: string[]) =>\n      dispatch(getResetStateWithoutInitial(loadingActions)),\n  });\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from 'react';\nimport { MenuItem, Select } from '@material-ui/core';\nimport { Maybe, Project } from '../../types';\nimport { useSelectStyles as useStyles } from '../../utils/styles';\n\ntype ProjectSelectProps = {\n  project: Maybe<string>;\n  projects: Array<Project>;\n  onSelect: (project: Maybe<string>) => void;\n};\n\nexport const ProjectSelect = ({\n  project,\n  projects,\n  onSelect,\n}: ProjectSelectProps) => {\n  const classes = useStyles();\n\n  const projectOptions = projects\n    .filter(p => p.id)\n    .sort((a, b) =>\n      ((a.name ?? a.id) as string).localeCompare((b.name ?? b.id) as string),\n    );\n\n  const handleOnChange = (e: React.ChangeEvent<{ value: unknown }>) => {\n    onSelect(e.target.value as string);\n  };\n\n  const renderValue = (value: unknown) => {\n    const proj = value as string;\n    const projectObj = projects.find(p => p.id === proj);\n    return (\n      <b data-testid={`selected-${proj}`}>\n        {proj === 'all' ? 'All Projects' : projectObj?.name ?? proj}\n      </b>\n    );\n  };\n\n  return (\n    <Select\n      className={classes.select}\n      variant=\"outlined\"\n      value={project ?? 'all'}\n      renderValue={renderValue}\n      onChange={handleOnChange}\n      data-testid=\"project-filter-select\"\n    >\n      {[{ id: 'all' }, ...projectOptions].map(proj => (\n        <MenuItem\n          className={`${classes.menuItem} compact`}\n          key={proj.id}\n          value={proj.id}\n          data-testid={`option-${proj.id}`}\n        >\n          {proj.id === 'all' ? 'All Projects' : proj.name ?? proj.id}\n        </MenuItem>\n      ))}\n    </Select>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport {\n  Box,\n  Collapse,\n  Container,\n  Divider,\n  Grid,\n  Typography,\n} from '@material-ui/core';\nimport { default as MaterialAlert } from '@material-ui/lab/Alert';\nimport { costInsightsApiRef } from '../../api';\nimport { ActionItems } from '../ActionItems';\nimport { AlertInsights } from '../AlertInsights';\nimport { CostInsightsLayout } from '../CostInsightsLayout';\nimport { CopyUrlToClipboard } from '../CopyUrlToClipboard';\nimport { CurrencySelect } from '../CurrencySelect';\nimport { WhyCostsMatter } from '../WhyCostsMatter';\nimport {\n  CostInsightsHeader,\n  CostInsightsHeaderNoGroups,\n} from '../CostInsightsHeader';\nimport { CostInsightsNavigation } from '../CostInsightsNavigation';\nimport { CostOverviewCard } from '../CostOverviewCard';\nimport { ProductInsights } from '../ProductInsights';\n/* https://github.com/backstage/backstage/issues/2574 */\n// import { CostInsightsSupportButton } from '../CostInsightsSupportButton';\nimport {\n  useConfig,\n  useCurrency,\n  useFilters,\n  useGroups,\n  useLastCompleteBillingDate,\n  useLoading,\n} from '../../hooks';\nimport { Alert, Cost, Maybe, MetricData, Product, Project } from '../../types';\nimport { mapLoadingToProps } from './selector';\nimport { ProjectSelect } from '../ProjectSelect';\nimport { intervalsOf } from '../../utils/duration';\nimport { useSubtleTypographyStyles } from '../../utils/styles';\nimport {\n  isAlertActive,\n  isAlertAccepted,\n  isAlertDismissed,\n  isAlertSnoozed,\n} from '../../utils/alerts';\n\nimport { Progress } from '@backstage/core-components';\nimport { useApi } from '@backstage/core-plugin-api';\n\nexport const CostInsightsPage = () => {\n  const classes = useSubtleTypographyStyles();\n  const client = useApi(costInsightsApiRef);\n  const config = useConfig();\n  const groups = useGroups();\n  const lastCompleteBillingDate = useLastCompleteBillingDate();\n  const [alerts, setAlerts] = useState<Alert[]>([]);\n  const [currency, setCurrency] = useCurrency();\n  const [projects, setProjects] = useState<Maybe<Project[]>>(null);\n  const [products, setProducts] = useState<Maybe<Product[]>>(null);\n  const [dailyCost, setDailyCost] = useState<Maybe<Cost>>(null);\n  const [metricData, setMetricData] = useState<Maybe<MetricData>>(null);\n  const [error, setError] = useState<Maybe<Error>>(null);\n\n  const { pageFilters, setPageFilters } = useFilters(p => p);\n\n  const active = useMemo(() => alerts.filter(isAlertActive), [alerts]);\n  const snoozed = useMemo(() => alerts.filter(isAlertSnoozed), [alerts]);\n  const accepted = useMemo(() => alerts.filter(isAlertAccepted), [alerts]);\n  const dismissed = useMemo(() => alerts.filter(isAlertDismissed), [alerts]);\n\n  const isActionItemsDisplayed = !!active.length;\n  const isAlertInsightsDisplayed = !!alerts.length;\n\n  const {\n    loadingActions,\n    loadingGroups,\n    loadingBillingDate,\n    loadingInitial,\n    dispatchInitial,\n    dispatchInsights,\n    dispatchNone,\n    dispatchReset,\n  } = useLoading(mapLoadingToProps);\n\n  /* eslint-disable react-hooks/exhaustive-deps */\n  // The dispatchLoading functions are derived from loading state using mapLoadingToProps, to\n  // provide nicer props for the component. These are re-derived whenever loading state changes,\n  // which causes an infinite loop as product panels load and re-trigger the useEffect below.\n  // Since the functions don't change, we can memoize - but we trigger the same loop if we satisfy\n  // exhaustive-deps by including the function itself in dependencies.\n\n  const dispatchLoadingInitial = useCallback(dispatchInitial, []);\n  const dispatchLoadingInsights = useCallback(dispatchInsights, []);\n  const dispatchLoadingNone = useCallback(dispatchNone, []);\n  const dispatchLoadingReset = useCallback(dispatchReset, []);\n  /* eslint-enable react-hooks/exhaustive-deps */\n\n  const setProject = (project: Maybe<string>) =>\n    setPageFilters({\n      ...pageFilters,\n      project: project === 'all' ? null : project,\n    });\n\n  useEffect(() => {\n    async function getInsights() {\n      setError(null);\n      try {\n        if (pageFilters.group) {\n          dispatchLoadingInsights(true);\n          const intervals = intervalsOf(\n            pageFilters.duration,\n            lastCompleteBillingDate,\n          );\n          const [\n            fetchedProjects,\n            fetchedAlerts,\n            fetchedMetricData,\n            fetchedDailyCost,\n          ] = await Promise.all([\n            client.getGroupProjects(pageFilters.group),\n            client.getAlerts(pageFilters.group),\n            pageFilters.metric\n              ? client.getDailyMetricData(pageFilters.metric, intervals)\n              : null,\n            pageFilters.project\n              ? client.getProjectDailyCost(pageFilters.project, intervals)\n              : client.getGroupDailyCost(pageFilters.group, intervals),\n          ]);\n          setProjects(fetchedProjects);\n          setAlerts(fetchedAlerts);\n          setMetricData(fetchedMetricData);\n          setDailyCost(fetchedDailyCost);\n        } else {\n          dispatchLoadingNone(loadingActions);\n        }\n      } catch (e) {\n        setError(e);\n        dispatchLoadingNone(loadingActions);\n      } finally {\n        dispatchLoadingInitial(false);\n        dispatchLoadingInsights(false);\n      }\n    }\n\n    // Wait for metadata to finish loading\n    if (!(loadingGroups && loadingBillingDate)) {\n      getInsights();\n    }\n  }, [\n    client,\n    pageFilters,\n    loadingActions,\n    loadingGroups,\n    loadingBillingDate,\n    dispatchLoadingInsights,\n    dispatchLoadingInitial,\n    dispatchLoadingNone,\n    lastCompleteBillingDate,\n  ]);\n\n  if (loadingInitial) {\n    return <Progress />;\n  }\n\n  if (error) {\n    return <MaterialAlert severity=\"error\">{error.message}</MaterialAlert>;\n  }\n\n  // Loaded but no groups found for the user\n  if (!pageFilters.group) {\n    return (\n      <CostInsightsLayout groups={groups}>\n        <Box textAlign=\"right\">\n          <CopyUrlToClipboard />\n          {/* <CostInsightsSupportButton /> */}\n        </Box>\n        <Container maxWidth=\"lg\">\n          <CostInsightsHeaderNoGroups />\n        </Container>\n        <Divider />\n        <Container maxWidth=\"lg\">\n          <WhyCostsMatter />\n        </Container>\n      </CostInsightsLayout>\n    );\n  }\n\n  if (!dailyCost) {\n    return (\n      <MaterialAlert severity=\"error\">{`Error: Could not fetch cost insights data for team ${pageFilters.group}`}</MaterialAlert>\n    );\n  }\n\n  const onProjectSelect = (project: Maybe<string>) => {\n    setProject(project);\n    dispatchLoadingReset(loadingActions);\n  };\n\n  const CostOverviewBanner = () => (\n    <Box\n      px={3}\n      pt={6}\n      display=\"flex\"\n      justifyContent=\"space-between\"\n      alignItems=\"center\"\n      minHeight={40}\n    >\n      <Box>\n        <Typography variant=\"h4\">Cost Overview</Typography>\n        <Typography classes={classes}>\n          Billing data as of {lastCompleteBillingDate}\n        </Typography>\n      </Box>\n      <Box display=\"flex\">\n        <Box mr={1}>\n          <CurrencySelect\n            currency={currency}\n            currencies={config.currencies}\n            onSelect={setCurrency}\n          />\n        </Box>\n        <ProjectSelect\n          project={pageFilters.project}\n          projects={projects || []}\n          onSelect={onProjectSelect}\n        />\n      </Box>\n    </Box>\n  );\n\n  return (\n    <CostInsightsLayout groups={groups}>\n      <Grid container wrap=\"nowrap\">\n        <Grid item>\n          <Box position=\"sticky\" top={20}>\n            <CostInsightsNavigation\n              products={products}\n              alerts={active.length}\n            />\n          </Box>\n        </Grid>\n        <Grid item xs>\n          <Box\n            display=\"flex\"\n            flexDirection=\"row\"\n            justifyContent=\"flex-end\"\n            mb={2}\n          >\n            <CopyUrlToClipboard />\n            {/* <CostInsightsSupportButton /> */}\n          </Box>\n          <Container maxWidth=\"lg\" disableGutters>\n            <Grid container direction=\"column\">\n              <Grid item xs>\n                <CostInsightsHeader\n                  owner={pageFilters.group}\n                  groups={groups}\n                  hasCostData={!!dailyCost.aggregation.length}\n                  alerts={active.length}\n                />\n              </Grid>\n              <Collapse in={isActionItemsDisplayed} enter={false}>\n                <Grid item xs>\n                  <Box px={3} py={6}>\n                    <ActionItems\n                      active={active}\n                      snoozed={snoozed}\n                      accepted={accepted}\n                      dismissed={dismissed}\n                    />\n                  </Box>\n                </Grid>\n                <Divider />\n              </Collapse>\n              <Grid item xs>\n                <CostOverviewBanner />\n              </Grid>\n              <Grid item xs>\n                <Box px={3} py={6}>\n                  {!!dailyCost.aggregation.length && (\n                    <CostOverviewCard\n                      dailyCostData={dailyCost}\n                      metricData={metricData}\n                    />\n                  )}\n                  <WhyCostsMatter />\n                </Box>\n              </Grid>\n              <Collapse in={isAlertInsightsDisplayed} enter={false}>\n                <Grid item xs>\n                  <Box px={6} py={6} mx={-3} bgcolor=\"alertBackground\">\n                    <AlertInsights\n                      group={pageFilters.group}\n                      active={active}\n                      snoozed={snoozed}\n                      accepted={accepted}\n                      dismissed={dismissed}\n                      onChange={setAlerts}\n                    />\n                  </Box>\n                </Grid>\n              </Collapse>\n              {!isAlertInsightsDisplayed && <Divider />}\n              <Grid item xs>\n                <Box px={3} py={6}>\n                  <ProductInsights\n                    group={pageFilters.group}\n                    project={pageFilters.project}\n                    products={config.products}\n                    onLoaded={setProducts}\n                  />\n                </Box>\n              </Grid>\n            </Grid>\n          </Container>\n        </Grid>\n      </Grid>\n    </CostInsightsLayout>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { CostInsightsPage } from './CostInsightsPage';\nimport { FilterProvider } from '../../hooks/useFilters';\nimport { LoadingProvider } from '../../hooks/useLoading';\nimport { GroupsProvider } from '../../hooks/useGroups';\nimport { CurrencyProvider } from '../../hooks/useCurrency';\nimport { ScrollProvider } from '../../hooks/useScroll';\nimport { ConfigProvider } from '../../hooks/useConfig';\nimport { BillingDateProvider } from '../../hooks/useLastCompleteBillingDate';\nimport { CostInsightsThemeProvider } from './CostInsightsThemeProvider';\n\nexport const CostInsightsPageRoot = () => (\n  <CostInsightsThemeProvider>\n    <ConfigProvider>\n      <LoadingProvider>\n        <GroupsProvider>\n          <BillingDateProvider>\n            <FilterProvider>\n              <ScrollProvider>\n                <CurrencyProvider>\n                  <CostInsightsPage />\n                </CurrencyProvider>\n              </ScrollProvider>\n            </FilterProvider>\n          </BillingDateProvider>\n        </GroupsProvider>\n      </LoadingProvider>\n    </ConfigProvider>\n  </CostInsightsThemeProvider>\n);\n"],"names":["useStyles","MuiAlert","choose","Tooltip","TooltipItem","RechartsTooltip","mapLoadingToProps","MaterialAlert"],"mappings":"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"}